<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAS Calculator</title>
    <style>
        :root { --primary: #00897b; --bg: #f4f7f6; --text: #333; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 100px; color: var(--text); }
        
        .nav { background: white; padding: 15px; position: sticky; top: 0; z-index: 10; box-shadow: 0 1px 3px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center; }
        .nav a { text-decoration: none; color: var(--primary); font-weight: bold; }
        .nav h1 { margin: 0; font-size: 1.2rem; }

        .controls { padding: 10px; display: flex; gap: 10px; justify-content: center; background: #fff; border-bottom: 1px solid #eee; }
        .btn-text { background: none; border: 1px solid #ccc; padding: 5px 10px; border-radius: 4px; font-size: 0.9rem; cursor: pointer; }

        .container { max-width: 800px; margin: 0 auto; padding: 15px; }
        .joint-card { background: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .joint-title { font-weight: bold; margin-bottom: 10px; color: var(--primary); border-bottom: 2px solid #eee; padding-bottom: 5px; display: flex; justify-content: space-between; }
        
        .muscle-group { margin-bottom: 12px; }
        .muscle-label { font-size: 0.85rem; color: #666; margin-bottom: 5px; font-weight: 600; display: flex; justify-content: space-between;}
        
        /* Segmented Buttons for MAS: 0, 1, 1+, 2, 3, 4 */
        .scale-group { display: flex; border: 1px solid var(--primary); border-radius: 6px; overflow: hidden; width: 100%; }
        .scale-btn { 
            flex: 1; padding: 8px 0; border: none; background: white; cursor: pointer; 
            border-right: 1px solid var(--primary); color: var(--primary); font-weight: bold; font-size: 14px;
            transition: 0.1s;
        }
        .scale-btn:last-child { border-right: none; }
        .scale-btn.selected { background: var(--primary); color: white; }
        
        /* Floating Result Bar */
        .fab { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); display: flex; gap: 10px; max-width: 800px; margin: 0 auto; }
        .btn-copy { flex: 2; background: var(--primary); color: white; border: none; padding: 12px; border-radius: 6px; font-size: 1rem; font-weight: bold; }
        .btn-reset { flex: 1; background: #eee; border: none; border-radius: 6px; color: #555; }

        @media (min-width: 600px) {
            .row-desktop { display: flex; gap: 20px; }
            .col-desktop { flex: 1; }
        }
    </style>
</head>
<body>

<div class="nav">
    <a href="index.html">‚Üê Back</a>
    <h1>Modified Ashworth Scale</h1>
    <div style="width: 40px;"></div>
</div>

<div class="controls">
    <button class="btn-text" onclick="setAll('0')">Set All Normal (0)</button>
</div>

<div class="container" id="app">
    <div class="joint-card">
        <div class="joint-title"><span>Elbow</span></div>
        <div class="row-desktop">
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Flexor</span></div>
                    <div class="scale-group" data-id="L_Elbow_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Extensor</span></div>
                    <div class="scale-group" data-id="L_Elbow_Ext"></div>
                </div>
            </div>
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Flexor</span></div>
                    <div class="scale-group" data-id="R_Elbow_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Extensor</span></div>
                    <div class="scale-group" data-id="R_Elbow_Ext"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="joint-card">
        <div class="joint-title"><span>Wrist</span></div>
        <div class="row-desktop">
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Flexor</span></div>
                    <div class="scale-group" data-id="L_Wrist_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Extensor</span></div>
                    <div class="scale-group" data-id="L_Wrist_Ext"></div>
                </div>
            </div>
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Flexor</span></div>
                    <div class="scale-group" data-id="R_Wrist_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Extensor</span></div>
                    <div class="scale-group" data-id="R_Wrist_Ext"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="joint-card">
        <div class="joint-title"><span>Knee</span></div>
        <div class="row-desktop">
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Flexor</span></div>
                    <div class="scale-group" data-id="L_Knee_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Extensor</span></div>
                    <div class="scale-group" data-id="L_Knee_Ext"></div>
                </div>
            </div>
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Flexor</span></div>
                    <div class="scale-group" data-id="R_Knee_Flex"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Extensor</span></div>
                    <div class="scale-group" data-id="R_Knee_Ext"></div>
                </div>
            </div>
        </div>
    </div>
    
     <div class="joint-card">
        <div class="joint-title"><span>Ankle</span></div>
        <div class="row-desktop">
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Plantar Flexor</span></div>
                    <div class="scale-group" data-id="L_Ankle_PF"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>L't Dorsiflexor</span></div>
                    <div class="scale-group" data-id="L_Ankle_DF"></div>
                </div>
            </div>
            <div class="col-desktop">
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Plantar Flexor</span></div>
                    <div class="scale-group" data-id="R_Ankle_PF"></div>
                </div>
                <div class="muscle-group">
                    <div class="muscle-label"><span>R't Dorsiflexor</span></div>
                    <div class="scale-group" data-id="R_Ankle_DF"></div>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="fab">
    <button class="btn-reset" onclick="resetAll()">Reset</button>
    <button class="btn-copy" onclick="copyResult()">Copy Note</button>
</div>

<script>
    // Initialize buttons
    const scores = ['0', '1', '1+', '2', '3', '4'];
    
    document.querySelectorAll('.scale-group').forEach(group => {
        scores.forEach(score => {
            const btn = document.createElement('button');
            btn.className = 'scale-btn';
            btn.innerText = score;
            btn.onclick = function() {
                group.querySelectorAll('.scale-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
            };
            group.appendChild(btn);
        });
    });

    function setAll(val) {
        document.querySelectorAll('.scale-group').forEach(group => {
            group.querySelectorAll('.scale-btn').forEach(b => {
                b.classList.remove('selected');
                if(b.innerText === val) b.classList.add('selected');
            });
        });
    }

    function resetAll() {
        document.querySelectorAll('.scale-btn').forEach(b => b.classList.remove('selected'));
    }

    function getVal(id) {
        const sel = document.querySelector(`.scale-group[data-id="${id}"] .selected`);
        return sel ? sel.innerText : null; // Return null if not selected
    }

    function copyResult() {
        // Only include joints that have at least one value selected to keep note clean
        let lines = [];
        
        // Helper to format line: "Elbow Flex/Ext: 1+/0"
        const formatJoint = (side, joint, flexId, extId) => {
            const f = getVal(`${side}_${joint}_Flex`) || getVal(`${side}_${joint}_PF`); // Handle PF for ankle
            const e = getVal(`${side}_${joint}_Ext`) || getVal(`${side}_${joint}_DF`); // Handle DF for ankle
            
            if (f || e) {
                return `${side} ${joint}: ${f||'NT'}/${e||'NT'}`; // NT = Not Tested
            }
            return null;
        };

        // Upper Limb
        let upperL = [formatJoint('L', 'Elbow', 'L_Elbow_Flex', 'L_Elbow_Ext'), formatJoint('L', 'Wrist', 'L_Wrist_Flex', 'L_Wrist_Ext')].filter(x=>x).join(', ');
        let upperR = [formatJoint('R', 'Elbow', 'R_Elbow_Flex', 'R_Elbow_Ext'), formatJoint('R', 'Wrist', 'R_Wrist_Flex', 'R_Wrist_Ext')].filter(x=>x).join(', ');
        
        // Lower Limb
        let lowerL = [formatJoint('L', 'Knee', 'L_Knee_Flex', 'L_Knee_Ext'), formatJoint('L', 'Ankle', 'L_Ankle_PF', 'L_Ankle_DF')].filter(x=>x).join(', ');
        let lowerR = [formatJoint('R', 'Knee', 'R_Knee_Flex', 'R_Knee_Ext'), formatJoint('R', 'Ankle', 'R_Ankle_PF', 'R_Ankle_DF')].filter(x=>x).join(', ');

        let text = "Modified Ashworth Scale (MAS):\n";
        if (upperR || upperL) text += `UE: (R) ${upperR || 'NT'} | (L) ${upperL || 'NT'}\n`;
        if (lowerR || lowerL) text += `LE: (R) ${lowerR || 'NT'} | (L) ${lowerL || 'NT'}\n`;
        
        if (!upperR && !upperL && !lowerR && !lowerL) {
            text += "No assessment recorded.";
        }

        navigator.clipboard.writeText(text).then(() => {
            const btn = document.querySelector('.btn-copy');
            btn.innerText = "Copied!";
            setTimeout(() => btn.innerText = "Copy Note", 1500);
        });
    }
</script>

</body>
</html>
